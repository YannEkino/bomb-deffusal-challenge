var T=Object.defineProperty;var E=(d,e,s)=>e in d?T(d,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):d[e]=s;var v=(d,e,s)=>E(d,typeof e!="symbol"?e+"":e,s);import{d as A,r as c,g as x,h as P,c as l,b as t,e as z,t as g,F as B,k as N,i as b,n as M,u as U,o as u}from"./index-2ZKqHTfF.js";import{C as D}from"./CountdownTimer-DlxtcF04.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";class m{constructor(e={}){v(this,"recognition");v(this,"isListening",!1);v(this,"resultReceived",!1);if(!m.isSupported())throw new Error("Speech Recognition API is not supported in this browser");const s=window.SpeechRecognition||window.webkitSpeechRecognition;this.recognition=new s,this.recognition.lang=e.lang||"en-US",this.recognition.continuous=e.continuous||!1,this.recognition.interimResults=e.interimResults||!1,this.recognition.maxAlternatives=e.maxAlternatives||1}static isSupported(){return!!(window.SpeechRecognition||window.webkitSpeechRecognition)}start(){return new Promise((e,s)=>{if(this.isListening){s(new Error("Speech recognition is already running"));return}this.recognition.onstart=()=>{this.isListening=!0,e()},this.recognition.onerror=n=>{s({error:n.error,message:this.getErrorMessage(n.error)})};try{this.recognition.start()}catch(n){s(n)}})}stop(){this.isListening&&(this.recognition.stop(),this.isListening=!1)}listen(){return new Promise((e,s)=>{this.resultReceived=!1,this.recognition.onresult=n=>{this.resultReceived=!0;const r=n.results[0][0];e({transcript:r.transcript,confidence:r.confidence})},this.recognition.onerror=n=>{this.isListening=!1,s({error:n.error,message:this.getErrorMessage(n.error)})},this.recognition.onend=()=>{this.isListening=!1,this.resultReceived||s({error:"no-speech",message:"No speech was detected"})},this.isListening||this.start().catch(s)})}isActive(){return this.isListening}static compareTranscript(e,s,n=!0){const r=e.toLowerCase().trim(),i=s.toLowerCase().trim();return n?r.includes(i)||i.includes(r):r===i}getErrorMessage(e){switch(e){case"no-speech":return"No speech was detected. Please try again.";case"aborted":return"Speech recognition was aborted.";case"audio-capture":return"No microphone was found or microphone is disabled.";case"network":return"Network error occurred during speech recognition.";case"not-allowed":case"service-not-allowed":return"Microphone permission was denied. Please allow microphone access.";case"bad-grammar":return"Speech grammar error.";case"language-not-supported":return"The language specified is not supported.";default:return"An unknown error occurred during speech recognition."}}}const I={class:"unlock-bomb-container"},V={class:"timer-container"},q={key:0,class:"error-message"},O={key:1,class:"error-message"},Y={key:2,class:"challenge-container"},G={class:"instructions"},H={class:"code-options"},J={class:"speech-container"},K=["disabled"],Q={key:0,class:"recognition-result"},W={class:"transcript"},X={key:1,class:"attempt-feedback"},Z={class:"attempts"},$={key:2,class:"success-message"},j=2,ee=A({__name:"UnlockBombView",setup(d){const e=U(),s=c(null),n=c(m.isSupported()),r=c(null),i=c(!1),p=c(""),f=c(""),h=c(!1),w=c(0),k=["Alpha Tango Foxtrot","Bravo Echo Delta","Charlie Oscar Delta Echo","Delta Lima Tango","Echo Sierra Charlie Alpha Papa Echo"];function S(){if(!n.value){p.value="Speech Recognition API is not supported in your browser";return}try{r.value=new m({lang:"en-US",continuous:!1,interimResults:!1})}catch(a){console.error("Error initializing speech recognition:",a),p.value="Failed to initialize speech recognition"}}async function _(){if(!(!r.value&&(S(),!r.value))){p.value="",i.value=!0,f.value="";try{await r.value.start();const a=await r.value.listen();R(a)}catch(a){console.error("Speech recognition error:",a),p.value=a.message||"Speech recognition failed",i.value=!1}}}function R(a){i.value=!1,f.value=a.transcript,w.value++,m.compareTranscript(a.transcript,k[j],!0)&&(h.value=!0)}function y(){e.push("/defuse-bomb")}return x(()=>{r.value&&i.value&&r.value.stop()}),P(()=>{S()}),(a,o)=>(u(),l("div",I,[o[7]||(o[7]=t("h1",null,"Step 2: Unlock the Bomb",-1)),t("div",V,[z(D,{ref_key:"timerRef",ref:s,start:!0},null,512)]),n.value?p.value?(u(),l("div",O,[t("p",null,g(p.value),1),t("button",{onClick:_,class:"retry-button"},"Retry")])):(u(),l("div",Y,[t("div",G,[o[1]||(o[1]=t("p",null,"The bomb's control panel requires voice authentication to unlock.",-1)),o[2]||(o[2]=t("p",null,"You need to speak the correct code phrase from the list below:",-1)),t("div",H,[t("ul",null,[(u(),l(B,null,N(k,(C,L)=>t("li",{key:L},g(C),1)),64))])]),o[3]||(o[3]=t("p",{class:"hint"},"Only one of these codes will work. Choose wisely!",-1))]),t("div",J,[t("button",{onClick:_,class:M(["mic-button",{listening:i.value,disabled:h.value}]),disabled:i.value||h.value},g(i.value?"Listening...":"Speak Code"),11,K),f.value?(u(),l("div",Q,[o[4]||(o[4]=t("p",null,"Recognized speech:",-1)),t("div",W,g(f.value),1)])):b("",!0),w.value>0&&!h.value?(u(),l("div",X,[o[5]||(o[5]=t("p",{class:"wrong"},"Incorrect code. Try again!",-1)),t("p",Z,"Attempts: "+g(w.value),1)])):b("",!0),h.value?(u(),l("div",$,[o[6]||(o[6]=t("p",null,"Authentication successful! The bomb has been unlocked.",-1)),t("button",{onClick:y,class:"proceed-button"},"Proceed to Defuse the Bomb")])):b("",!0)])])):(u(),l("div",q,o[0]||(o[0]=[t("p",null,"Your browser doesn't support speech recognition, which is required for this challenge.",-1),t("p",null,"Please try using Chrome or Edge on desktop, or Chrome on Android.",-1)])))]))}}),re=F(ee,[["__scopeId","data-v-a6e2e7fd"]]);export{re as default};
//# sourceMappingURL=UnlockBombView-CKPfWlbC.js.map
