import{d as q,r as l,f as p,h as I,g as N,c as o,b as e,e as T,t as r,i as _,l as g,n as x,u as L,o as i}from"./index-2ZKqHTfF.js";import{C as P}from"./CountdownTimer-DlxtcF04.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"defuse-bomb-container"},$={class:"timer-container"},z={key:0,class:"error-message"},G={key:1,class:"error-message"},R={key:2,class:"challenge-container"},Y={class:"instructions"},H={key:0,class:"warning"},U={key:0,class:"permission-container"},W={key:1,class:"orientation-container"},X={class:"bubble-level-container"},j={class:"bubble-level"},J={class:"orientation-values"},K={class:"orientation-value"},Q={class:"orientation-value"},Z={class:"progress-container"},ee={class:"progress-label"},te={class:"progress-bar"},se={key:0,class:"stability-progress"},ae={class:"stability-label"},ne={class:"stability-bar"},oe={key:2,class:"success-panel"},f=5,ie=q({__name:"DefuseBombView",setup(le){const E=L(),S=l(null),h=l(!!window.DeviceOrientationEvent),s=l({alpha:null,beta:null,gamma:null}),v=l(""),m=l(!1),w=l(!1),d=l(0),a=l(null),u=p(()=>s.value.beta===null?null:Math.abs(s.value.beta)),c=p(()=>s.value.gamma===null?null:Math.abs(s.value.gamma)),D=p(()=>{if(u.value===null||c.value===null)return 0;const n=15,t=15,O=Math.max(0,100-u.value/n*100),A=Math.max(0,100-c.value/t*100);return Math.min(O,A)}),b=p(()=>u.value===null||c.value===null?!1:u.value<5&&c.value<5);function y(n){s.value={alpha:n.alpha,beta:n.beta,gamma:n.gamma}}async function C(){try{typeof DeviceOrientationEvent<"u"&&typeof DeviceOrientationEvent.requestPermission=="function"?await DeviceOrientationEvent.requestPermission()==="granted"?(m.value=!0,window.addEventListener("deviceorientation",y),k()):v.value="Permission to access device orientation was denied":(console.log("No permission needed for this browser/device, proceeding directly"),m.value=!0,window.addEventListener("deviceorientation",y),k())}catch(n){console.error("Error requesting device orientation permission:",n),v.value="Could not access device orientation"}}function k(){a.value&&clearInterval(a.value),a.value=window.setInterval(()=>{b.value?(d.value+=.1,d.value>=f&&M()):d.value=0},100)}function M(){w.value=!0,a.value&&(clearInterval(a.value),a.value=null)}function B(){E.push("/")}return I(()=>{h.value||(v.value="Device orientation is not supported on your device")}),N(()=>{a.value&&(clearInterval(a.value),a.value=null),window.removeEventListener("deviceorientation",y)}),(n,t)=>(i(),o("div",F,[t[7]||(t[7]=e("h1",null,"Step 3: Defuse the Bomb",-1)),e("div",$,[T(P,{ref_key:"timerRef",ref:S,start:!0},null,512)]),h.value?v.value?(i(),o("div",G,[e("p",null,r(v.value),1)])):(i(),o("div",R,[e("div",Y,[t[1]||(t[1]=e("p",null,"To defuse the bomb, you need to place your device on a flat surface and keep it perfectly level.",-1)),e("p",null,"Hold it steady for "+r(f)+" seconds to complete the defusal process."),m.value?_("",!0):(i(),o("p",H,"You need to grant permission to access your device's orientation sensors."))]),m.value?(i(),o("div",W,[e("div",X,[e("div",j,[e("div",{class:"bubble",style:g({transform:`translate(${s.value.gamma?s.value.gamma*3:0}px, ${s.value.beta?s.value.beta*3:0}px)`,backgroundColor:b.value?"#33ff33":"#ff3333"})},null,4)])]),e("div",J,[e("div",K,[t[2]||(t[2]=e("label",null,"X-axis (β):",-1)),e("span",{class:x({good:u.value!==null&&u.value<5})},r(s.value.beta!==null?s.value.beta.toFixed(2):"N/A")+"° ",3)]),e("div",Q,[t[3]||(t[3]=e("label",null,"Y-axis (γ):",-1)),e("span",{class:x({good:c.value!==null&&c.value<5})},r(s.value.gamma!==null?s.value.gamma.toFixed(2):"N/A")+"° ",3)])]),e("div",Z,[e("div",ee,"Device Level: "+r(Math.round(D.value))+"%",1),e("div",te,[e("div",{class:"progress",style:g({width:`${D.value}%`})},null,4)])]),b.value?(i(),o("div",se,[e("div",ae,"Stabilizing: "+r(d.value.toFixed(1))+"/"+r(f)+"s",1),e("div",ne,[e("div",{class:"stability-progress",style:g({width:`${d.value/f*100}%`})},null,4)]),t[4]||(t[4]=e("div",{class:"stability-message"},"Hold steady!",-1))])):_("",!0)])):(i(),o("div",U,[e("button",{onClick:C,class:"permission-button"},"Grant Sensor Access")])),w.value?(i(),o("div",oe,[t[5]||(t[5]=e("h2",null,"BOMB DEFUSED!",-1)),t[6]||(t[6]=e("p",null,"The bomb has been successfully defused. Well done!",-1)),e("button",{onClick:B,class:"success-button"},"Mission Complete")])):_("",!0)])):(i(),o("div",z,t[0]||(t[0]=[e("p",null,"Your device doesn't support orientation detection, which is required for this challenge.",-1),e("p",null,"Please try on a device with accelerometer/gyroscope sensors.",-1)])))]))}}),ve=V(ie,[["__scopeId","data-v-533fbce0"]]);export{ve as default};
//# sourceMappingURL=DefuseBombView-CL-fN7xn.js.map
